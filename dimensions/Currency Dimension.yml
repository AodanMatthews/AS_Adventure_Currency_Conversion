unique_name: Currency Dimension
object_type: dimension
label: Currency Dimension
calculation_groups:
  - unique_name: Actuals Vs Budgeted Rates
    label: Actuals Vs Budgeted Rates
    description: Actuals Vs Budgeted rate currency Conversions applied to other measures
    calculated_members:
      - unique_name: CY Actual Rates
        name: CY Actual Rates
        description: Actual reporting currency rate conversions for base measures
        expression: >- 
          [Measures].currentMember  * [Measures].[CY Actual Rate]
        format: '#,###.00;(#,###.00)'

      - unique_name: Actual Rates
        name: Actual Rates
        description: Actual reporting currency rate conversions for base measures
        expression: >- 
          [Measures].currentMember  * [Measures].[Actual Rate]
        format: '#,###.00;(#,###.00)'

      - unique_name: CY Budgeted Rates
        name: CY Budgeted Rates
        description: Budgeted reporting currency rate conversions for base measures
        expression: >-
          [Measures].currentMember * [Measures].[Budgeted Rate]
        format: '#,###.00;(#,###.00)'  
    folder: Currency Conversion

  - unique_name: CY Actual Rates
    label: CY Actual Rates
    description: Actuals Vs Budgeted rate currency Conversions applied to other measures
    calculated_members:
      - unique_name: CYTD Actual Rates
        name: CY Actual Rates
        description: Actual reporting currency rate conversions for base measures
        expression: >- 
          Sum(PeriodsToDate([Date Dimension].[Date Month Hierarchy].[YearMonth], [Date Dimension].[Date Month Hierarchy].CurrentMember), [Measures].currentMember) * [Measures].[Actual Rate]
        format: '#,###.00;(#,###.00)'

      - unique_name: PY Actual Rates
        name: Actual Rates
        description: Actual reporting currency rate conversions for base measures
        expression: >- 
          (ParallelPeriod([Date Dimension].[Date Month Hierarchy].[YearMonth], 1, [Date Dimension].[Date Month Hierarchy].CurrentMember), [Measures].currentMember) * [Measures].[Actual Rate]
        format: '#,###.00;(#,###.00)'

      - unique_name: YoY Actual Rates
        name: CY Budgeted Rates
        description: Budgeted reporting currency rate conversions for base measures
        expression: >-
          (([Date Dimension].[Date Month Hierarchy].CurrentMember, [Measures].[Sales Amount_sum]) - (ParallelPeriod([Date Dimension].[Date Month Hierarchy].[YearMonth], 1, [Date Dimension].[Date Month Hierarchy].CurrentMember), [Measures].currentMember ))  * [Measures].[Actual Rate]
        format: '#,###.00;(#,###.00)'  
    folder: CY Actuals

  - unique_name: Actual Rates
    label: Actual Rates
    description: Actuals Vs Budgeted rate currency Conversions applied to other measures
    calculated_members:
      - unique_name: CYTD Actual Rates
        name: CY Actual Rates
        description: Actual reporting currency rate conversions for base measures
        expression: >- 
          Sum(PeriodsToDate([Date Dimension].[Date Month Hierarchy].[YearMonth], [Date Dimension].[Date Month Hierarchy].CurrentMember), [Measures].currentMember) * [Measures].[Actual Rate]
        format: '#,###.00;(#,###.00)'

      - unique_name: PY Actual Rates
        name: Actual Rates
        description: Actual reporting currency rate conversions for base measures
        expression: >- 
          (ParallelPeriod([Date Dimension].[Date Month Hierarchy].[YearMonth], 1, [Date Dimension].[Date Month Hierarchy].CurrentMember), [Measures].currentMember) * [Measures].[Actual Rate]
        format: '#,###.00;(#,###.00)'

      - unique_name: YoY Actual Rates
        name: CY Budgeted Rates
        description: Budgeted reporting currency rate conversions for base measures
        expression: >-
          (([Date Dimension].[Date Month Hierarchy].CurrentMember, [Measures].[Sales Amount_sum]) - (ParallelPeriod([Date Dimension].[Date Month Hierarchy].[YearMonth], 1, [Date Dimension].[Date Month Hierarchy].CurrentMember), [Measures].currentMember ))  * [Measures].[Actual Rate]
        format: '#,###.00;(#,###.00)'  
    folder: Currency Conversion

hierarchies:
  - unique_name: Base Currency Hierarchy
    label: Base Currency Hierarchy
    filter_empty: 'yes'
    levels:
      - unique_name: Base Currency
  - unique_name: Reporting Currency Hierarchy
    label: Reporting Currency Hierarchy
    filter_empty: 'yes'
    levels:
      - unique_name: Reporting Currency
      - unique_name: Reporting Currency Join
      - unique_name: Reporting Date
level_attributes:
  - unique_name: Base Currency
    label: Base Currency
    contains_unique_names: false
    dataset: dimcurrency_base
    is_unique_key: false
    key_columns:
      - currencykey
    name_column: currencyalternatekey
  - unique_name: Reporting Currency Join
    label: Reporting Currency Join
    contains_unique_names: false
    dataset: factcurrencyrate_conversion
    is_hidden: true
    is_unique_key: false
    key_columns:
      - currencykey_to
    name_column: currencykey_to
  - unique_name: Reporting Currency
    label: Reporting Currency
    contains_unique_names: false
    dataset: dimcurrency_reporting
    is_unique_key: false
    key_columns:
      - currencykey
    name_column: currencyalternatekey
  - unique_name: Reporting Date
    label: Reporting Date
    contains_unique_names: false
    dataset: factcurrencyrate_conversion
    is_hidden: true
    is_unique_key: false
    key_columns:
      - datekey
    name_column: datekey
relationships:
  - from:
      dataset: factcurrencyrate_conversion
      join_columns:
        - currencykey_to
    to:
      level: Reporting Currency
    type: snowflake
type: standard
